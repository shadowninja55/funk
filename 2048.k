`prng@0
S:{,/(x;x/y;x)}
D:`0:S["\n",S["+";4 4#"-"],"\n"]@S["|"]'-4$$" "^
M:{,[!0;+/',/0N 2#/:(&~=':n)_n:x^0N]@!4}
R:{*1?4,9#2}
I:4 4#-16?(14#0N),R'!2
N:{.[n;*1?+&^n;(R;::)x~n:3 y/M'y x]}
D (|//^:){D x
  f:(+:;::;+|:;|:')"wasd"?*1:`
  :[^f;x;N[x]f]}/I
